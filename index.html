<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Kings Kingdom ‚Äì Repository Resources</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #020617;
      --card: #0f172a;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.15);
      --text: #e5e7eb;
      --muted: #9ca3af;
      --border: #1f2937;
      --radius: 16px;
      --shadow: 0 18px 40px rgba(15, 23, 42, 0.7);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #0b1120 0, #020617 55%, #000 100%);
      color: var(--text);
      display: flex;
      justify-content: center;
      padding: 24px 12px;
    }
    .page {
      width: 100%;
      max-width: 960px;
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.98), rgba(15, 23, 42, 0.96));
      border-radius: 24px;
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      padding: 18px 18px 22px;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-bottom: 14px;
      flex-wrap: wrap;
    }
    .title {
      font-size: 1.4rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .logo {
      width: 26px;
      height: 26px;
      border-radius: 50%;
      background: conic-gradient(from 210deg, #38bdf8, #6366f1, #a855f7, #38bdf8);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      color: #0b1120;
      box-shadow: 0 0 14px rgba(56, 189, 248, 0.7);
    }
    .subtitle {
      font-size: 0.85rem;
      color: var(--muted);
    }
    a {
      color: var(--accent);
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    .small { font-size: 0.8rem; }

    .search-row {
      margin: 8px 0 14px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
    }
    .search-label {
      font-size: 0.8rem;
      color: var(--muted);
    }
    .search-input {
      flex: 1 1 220px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(15, 23, 42, 0.95);
      color: var(--text);
      font-size: 0.85rem;
      outline: none;
    }
    .search-input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent-soft);
    }

    .folder-list {
      margin-top: 6px;
    }

    .folder {
      border-radius: 14px;
      border: 1px solid var(--border);
      background: var(--card);
      overflow: hidden;
    }
    .folder-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 8px 10px;
      user-select: none;
    }
    .folder-header-left {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .folder-icon {
      width: 24px;
      height: 24px;
      border-radius: 6px;
      background: linear-gradient(135deg, #facc15, #f97316);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      color: #111827;
    }
    .folder-title {
      font-size: 0.9rem;
      font-weight: 600;
    }
    .folder-meta {
      font-size: 0.75rem;
      color: var(--muted);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
    }
    th, td {
      padding: 5px 6px;
      border-bottom: 1px solid var(--border);
    }
    th {
      text-align: left;
      color: var(--muted);
      font-weight: 500;
      font-size: 0.78rem;
    }
    tr:last-child td {
      border-bottom: none;
    }

    .file-path {
      font-size: 0.8rem;
      color: var(--muted);
    }
    .file-main-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .file-icon {
      width: 18px;
      display: inline-block;
      text-align: center;
    }

    .tag {
      display: inline-flex;
      border-radius: 999px;
      padding: 2px 6px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      font-size: 0.7rem;
      color: var(--muted);
    }

    .status-bar {
      margin: 6px 0 0;
      font-size: 0.75rem;
      color: var(--muted);
      text-align: right;
    }

    footer {
      margin-top: 14px;
      font-size: 0.75rem;
      color: var(--muted);
      text-align: center;
    }
    .error {
      color: #fecaca;
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div>
        <div class="title">
          <span class="logo">K</span>
          <span>Kings Kingdom ‚Äì Resources</span>
        </div>
        <div class="subtitle">
          Auto-generated list of all files and folders in the
          <strong>Videos2727/Kings-Kingdom</strong> repository (main branch).
        </div>
      </div>
      <div class="small">
        <!-- optional back link -->
        <!-- <a href="index.html">‚Üê Back</a> -->
      </div>
    </header>

    <div class="search-row">
      <span class="search-label">Search by name or path:</span>
      <input
        id="search-input"
        class="search-input"
        type="search"
        placeholder="e.g. chemistry, exam, unit 3, pdf..."
      />
    </div>

    <div class="folder-list">
      <section class="folder">
        <div class="folder-header">
          <div class="folder-header-left">
            <div class="folder-icon">üìÅ</div>
            <div>
              <div class="folder-title">All resources</div>
              <div class="folder-meta" id="folder-meta">
                Loading repository contents...
              </div>
            </div>
          </div>
        </div>
        <div class="folder-body">
          <table>
            <thead>
              <tr>
                <th>Name / Path</th>
                <th style="width: 80px;">Kind</th>
                <th style="width: 80px;">Format</th>
              </tr>
            </thead>
            <tbody id="file-table-body">
              <!-- Rows injected by JavaScript -->
            </tbody>
          </table>
        </div>
      </section>
    </div>

    <div class="status-bar" id="status-bar"></div>

    <footer>
      This page uses the public GitHub API to read repository contents and render them with a searchable index.
    </footer>
  </div>

  <script>
    // Configured for: Videos2727 / Kings-Kingdom / main branch
    const OWNER = "Videos2727";
    const REPO = "Kings-Kingdom";
    const BRANCH = "main";
    const ROOT_PATH = "";   // "" = whole repo

    const folderMetaEl = document.getElementById("folder-meta");
    const tableBodyEl = document.getElementById("file-table-body");
    const statusBarEl = document.getElementById("status-bar");
    const searchInputEl = document.getElementById("search-input");

    async function fetchDirectory(path) {
      const apiUrl = `https://api.github.com/repos/${OWNER}/${REPO}/contents/${encodeURIComponent(path)}?ref=${BRANCH}`;
      const response = await fetch(apiUrl);
      if (!response.ok) {
        throw new Error(`GitHub API error ${response.status} for ${apiUrl}`);
      }
      return response.json();
    }

    async function traverseRepo(rootPath) {
      const items = [];
      async function walk(path) {
        const entries = await fetchDirectory(path);
        for (const entry of entries) {
          // Skip this index file itself if it's in the same folder
          if (
            entry.name === "index.html" &&
            entry.path === (ROOT_PATH ? ROOT_PATH + "/index.html" : "index.html")
          ) {
            continue;
          }
          items.push({
            name: entry.name,
            path: entry.path,
            type: entry.type, // "file" or "dir"
          });
          if (entry.type === "dir") {
            await walk(entry.path);
          }
        }
      }
      await walk(rootPath);
      return items;
    }

    function getExtension(name) {
      const idx = name.lastIndexOf(".");
      if (idx === -1) return "-";
      return name.slice(idx + 1).toLowerCase();
    }

    function makeRow(item) {
      const tr = document.createElement("tr");
      tr.dataset.name = item.name.toLowerCase();
      tr.dataset.path = item.path.toLowerCase();

      const isDir = item.type === "dir";
      const ext = isDir ? "-" : getExtension(item.name);

      const tdName = document.createElement("td");
      const mainLink = document.createElement("a");
      mainLink.className = "file-main-link";
      mainLink.target = "_blank";
      mainLink.rel = "noopener noreferrer";

      const iconSpan = document.createElement("span");
      iconSpan.className = "file-icon";
      iconSpan.textContent = isDir ? "üìÅ" : "üìÑ";

      const nameSpan = document.createElement("span");
      nameSpan.textContent = item.name;

      mainLink.appendChild(iconSpan);
      mainLink.appendChild(nameSpan);

      if (isDir) {
        // For folders, link to GitHub tree view
        mainLink.href = `https://github.com/${OWNER}/${REPO}/tree/${BRANCH}/${item.path}`;
      } else {
        // For files, use relative path so it works via GitHub Pages
        mainLink.href = item.path;
      }

      const pathDiv = document.createElement("div");
      pathDiv.className = "file-path";
      pathDiv.textContent = item.path;

      tdName.appendChild(mainLink);
      tdName.appendChild(pathDiv);

      const tdKind = document.createElement("td");
      const kindTag = document.createElement("span");
      kindTag.className = "tag";
      kindTag.textContent = isDir ? "Folder" : "File";
      tdKind.appendChild(kindTag);

      const tdFormat = document.createElement("td");
      tdFormat.textContent = ext.toUpperCase();

      tr.appendChild(tdName);
      tr.appendChild(tdKind);
      tr.appendChild(tdFormat);

      return tr;
    }

    function renderTable(items) {
      // sort: folders first, then files; then by path
      items.sort((a, b) => {
        if (a.type !== b.type) return a.type === "dir" ? -1 : 1;
        return a.path.localeCompare(b.path);
      });

      tableBodyEl.innerHTML = "";
      for (const item of items) {
        tableBodyEl.appendChild(makeRow(item));
      }
    }

    function applySearchFilter() {
      const q = searchInputEl.value.trim().toLowerCase();
      const rows = tableBodyEl.querySelectorAll("tr");
      let visible = 0;

      rows.forEach(row => {
        const name = row.dataset.name || "";
        const path = row.dataset.path || "";
        const match = !q || name.includes(q) || path.includes(q);
        row.style.display = match ? "" : "none";
        if (match) visible++;
      });

      if (q) {
        statusBarEl.textContent = `${visible} item(s) match "${q}"`;
      } else {
        statusBarEl.textContent = "";
      }
    }

    searchInputEl.addEventListener("input", applySearchFilter);

    (async function init() {
      try {
        const rootLabel = ROOT_PATH || "/";
        folderMetaEl.textContent = `Scanning repository ${OWNER}/${REPO} from "${rootLabel}"...`;
        const items = await traverseRepo(ROOT_PATH || "");
        renderTable(items);
        folderMetaEl.textContent = `Found ${items.length} item(s) in ${OWNER}/${REPO}${ROOT_PATH ? "/" + ROOT_PATH : ""}.`;
      } catch (err) {
        console.error(err);
        folderMetaEl.innerHTML = `<span class="error">Error loading repository contents.</span>`;
        statusBarEl.innerHTML = `<span class="error">${err.message}</span>`;
      }
    })();
  </script>
</body>
</html>
